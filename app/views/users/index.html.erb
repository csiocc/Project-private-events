<%= render "shared/profil_header" %>

<!-- Container -->
<div class="min-h-screen h-auto bg-gray-200 px-4 py-8">
  <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg p-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Alle Nutzer</h1>

    <!-- Suchfeld -->
    <div class="mb-6 flex justify-center">
      <input 
        type="text" 
        id="user_search" 
        placeholder="Suche nach Name oder Email..." 
        class="w-full max-w-md px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
        autocomplete="off"
      >
    </div>

    <!-- Userliste -->
    <div id="user_list" class="divide-y divide-gray-100">
      <% @users.order(:name).each do |user| %>
        <div class="flex items-center justify-between py-4 px-2 transition hover:bg-gray-50 user-row" data-name="<%= user.name.downcase %>" data-email="<%= user.email.downcase %>">
          <div>
            <span class="font-semibold text-lg text-gray-800"><%= user.name %></span>
            <span class="ml-2 text-sm text-gray-500"><%= user.email %></span>
          </div>
          <div>
            <% if current_user.following?(user) %>
              <%= button_to "Unfollow", unfollow_user_path(user), method: :post, class: "bg-red-100 hover:bg-red-200 text-red-800 px-4 py-1 rounded-full font-medium text-sm transition" %>
            <% else %>
              <%= button_to "Follow", follow_user_path(user), method: :post, class: "bg-blue-100 hover:bg-blue-200 text-blue-800 px-4 py-1 rounded-full font-medium text-sm transition" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<!-- Simple Live-Search JS -->
<script>
  document.addEventListener("input", function(e) {
    if (e.target.id === "user_search") {
      const term = e.target.value.toLowerCase();
      document.querySelectorAll("#user_list .user-row").forEach(row => {
        const name = row.getAttribute("data-name");
        const email = row.getAttribute("data-email");
        if (!term || name.includes(term) || email.includes(term)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
    }
  });
</script>






