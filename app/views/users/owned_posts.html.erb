<%= render "shared/profil_header" %>

<!-- Container -->
<div class="min-h-[95vh] bg-gray-100 px-4 py-8">
  <div class="max-w-3xl mx-auto bg-white rounded-2xl shadow-lg p-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">
      Posts von <%= @user.name %>
    </h1>

    <!-- Sortier-Button -->
    <div class="flex justify-end mb-6">
      <%= form_with url: owned_posts_user_path(@user), method: :get, local: true, class: "flex items-center gap-2" do %>
        <label for="sort" class="text-sm text-gray-700">Sortierung:</label>
        <%= select_tag :sort, options_for_select([["Datum ↓ (neu)", "desc"], ["Datum ↑ (alt)", "asc"]], params[:sort]), class: "border border-gray-300 rounded px-3 py-1 focus:ring-blue-400" %>
        <%= submit_tag "Sortieren", class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-1 rounded font-medium text-sm transition" %>
      <% end %>
    </div>

    <!-- Fehleranzeige, falls keine Posts -->
    <% if @posts.empty? %>
      <div class="bg-yellow-50 border border-yellow-200 text-yellow-700 px-5 py-4 rounded-xl text-center">
        <p><%= @user.name %> hat noch keine Posts veröffentlicht.</p>
      </div>
    <% end %>

    <!-- Posts-Liste -->
    <div class="space-y-6">
      <% @posts.each do |post| %>
        <div class="bg-gray-50 rounded-xl p-6 shadow border border-gray-100">
          <div class="flex justify-between items-center mb-2">
            <h2 class="text-xl font-semibold text-gray-800"><%= post.title %></h2>
            <span class="text-xs text-gray-500">
              <i class="bx bx-calendar"></i>
              <%= post.created_at.strftime("%d.%m.%Y %H:%M") %>
            </span>
          </div>
          <p class="text-gray-700 mb-4"><%= truncate(post.body, length: 200) %></p>
          <div class="flex gap-2 justify-end">
            <%= link_to "Details", post_path(post), class: "text-blue-600 hover:text-blue-800 text-sm font-medium" %>
            <% if post.user == current_user %>
              <%= link_to "Bearbeiten", edit_post_path(post), class: "text-gray-500 hover:text-gray-700 text-sm" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>